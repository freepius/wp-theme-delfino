/************************************************
 * STYLES FOR THE WORDPRESS GALLERY POSTS
 ***********************************************/

// Unset the default styles of the Wordpress block gallery.
@mixin wp-gallery-styles-unset {
    li {
        width: unset;
        position: unset;

        img {
            width: unset;
            object-fit: unset;
        }

        figcaption {
            width: unset;
            max-height: unset;
            padding: unset;
            background: unset;
            color: unset;
            text-align: unset;
            font-size: unset;
        }
    }
}

// CSS selector for the gallery 'other content' (serving as description)
$other-content: ':not(nav):not(figure.wp-block-gallery)';

body.single-format-gallery {
    > header, > nav {
        display: none;
    }

    > main {
        max-width: 2000px;
        height: calc(100vh - 32px);
        padding: 30px;
        padding-right: 0;

        display: grid;
        grid-template-columns: 20% 80%;
        grid-template-rows: 50% 50%;
        grid-template-areas: "a c" "b c";

        @media (max-width: 1000px) {
            grid-template-columns: 100%;
            grid-template-rows: auto 1fr 1fr auto;
            grid-template-areas: "a" "c" "c" "b";
        }

        // The "back to category" link
        > a#back-to-category {
            grid-area: a;
            align-self: start;
            width: max-content;
            @include link-bold;
            &::before { content: '< '; }
        }

        // Part containing <h1> gallery name, <h2> active photo legend and <a> gallery view activators
        > header {
            grid-area: b;
            align-self: end;

            > h1, > h2 { font-size: 1em; }
            > h2 { font-weight: 400; }

            > ul {
                @include list-inline;

                > li:not(:first-of-type)::before  {
                    content: '|';
                    margin: 0 10px;
                }

                a {
                    &.active {
                        font-weight: 700;
                        &:hover {
                            color: inherit;
                            cursor: default;
                        }
                    }

                    &:not(.active) {
                        text-decoration: none;
                    }
                }
            }
        }

        // Part containing the photos gallery and eventual complementary contents
        > section {
            grid-area: c;
            display: grid;
            justify-content: center;
            align-content: start;
            height: 100%;
            overflow-y: auto;

            // Other content of the WordPress post (serving as gallery description)
            > #{$other-content} {
                max-width: $breakpoint-sm;
                margin: 1rem auto;
            }

            // The photos gallery
            > figure.wp-block-gallery {
                padding-right: 30px;
                figcaption { @extend %invisible; }
            }

            // Links allowing to navigate through photos and gallery description
            &.description > nav,
            &.gallery > nav {
                position: absolute;
                display: grid;
                grid-template-columns: 1fr 1fr;
                width: calc(80% - 50px);
                height: 100%;
                top: 0;
                right: 20px; // <-- allow to not cover the scroll bar
                z-index: 1000;

                > a {
                    &[data-photo="prev"] { cursor: w-resize; }
                    &[data-photo="next"] { cursor: e-resize; }
                }
            }

            // Styles for the DESCRIPTION view
            &.description {
                > figure.wp-block-gallery {
                    display: none;
                }
            }

            // Styles for the INDEX view
            &.index {
                > nav{
                    display: none;
                }

                > figure.wp-block-gallery {
                    grid-row: 1 / 2; // <-- gallery is displayed before other content
                    display: flex;

                    li:hover {
                        opacity: .5;
                        cursor: pointer;
                    }
                }
            }

            // Styles for the GALLERY view
            &.gallery {
                > #{$other-content} {
                    display: none;
                }

                > figure.wp-block-gallery {
                    &, ul, li, figure {
                        height: 100%;
                        display: block;
                    }

                    @include wp-gallery-styles-unset;

                    li {
                        margin: 0;

                        img {
                            height: 100%;
                            margin: 0 auto;
                        }

                        // Do not use 'display: none;'
                        // Otherwise the image is not loaded (until its first display)
                        &.invisible {
                            @extend %invisible;
                        }
                    }
                }
            }
        }
    }
}