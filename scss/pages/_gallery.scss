/************************************************
 * STYLES FOR THE WORDPRESS GALLERY POSTS
 ***********************************************/

// Unset the default styles of the Wordpress block gallery.
@mixin wp-gallery-styles-unset {
    li {
        width: unset;
        position: unset;

        img {
            width: unset;
            object-fit: unset;
        }

        &.active {
           figcaption {
               width: unset;
               max-height: unset;
               padding: unset;
               background: unset;
               color: unset;
               text-align: unset;
               font-size: unset;
           }
        }
    }
}

body.single-format-gallery {
    > header, > nav {
        display: none;
    }

    > main {
        max-width: 2000px;
        height: calc(100vh - 32px);
        padding: 30px;
        padding-right: 0;

        display: grid;
        grid-template-columns: 20% 80%;
        grid-template-rows: 50% 50%;
        grid-template-areas: "a c" "b c";

        // The "back to category" link
        > a#back-to-category {
            grid-area: a;
            align-self: start;
            width: max-content;
            @include link-bold;
            &::before { content: '< '; }
        }

        // Part containing the gallery name (<h1>)
        // and 2 links allowing to switch between gallery and index views.
        > header {
            grid-area: b;
            align-self: end;

            > h1 { font-size: 1em; }

            > nav > a {
                &.active {
                    font-weight: 700;
                    &:hover {
                        color: inherit;
                        cursor: default;
                    }
                }

                &:not(.active) {
                    text-decoration: none;
                }
            }
        }

        // Part containing the photos gallery and eventual complementary texts/contents
        > section {
            grid-area: c;

            // By default, complementary texts/contents are hidden
            > * { display: none; }

            // The photos gallery
            > figure.wp-block-gallery {
                height: 100%;
                padding-right: 32px;
                figcaption { display: none; }
            }

            // Styles for the INDEX view
            &.index > figure.wp-block-gallery {
                display: flex;
                overflow-y: auto;

                li {
                    &:hover {
                        opacity: .5;
                        cursor: pointer;
                    }
                }
            }

            // Styles for the GALLERY view
            &.gallery {
                // 2 links allowing to display the previous and next photos
                > nav {
                    position: absolute;
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    width: 80%;
                    height: 100%;
                    top: 0;
                    right: 0;
                    z-index: 1000;

                    > a {
                        &[data-photo="prev"] { cursor: w-resize; }
                        &[data-photo="next"] { cursor: e-resize; }
                    }
                }

                > figure.wp-block-gallery {
                    &, ul, li, figure {
                        height: 100%;
                        display: block;
                    }

                    @include wp-gallery-styles-unset;

                    li {
                        img { margin: 0 auto; }

                        &:not(.active) {
                            display: none;
                        }

                        &.active {
                            display: block;

                            figcaption {
                                position: absolute;
                                display: initial;
                                max-width: 20%;
                                left: 30px;
                                bottom: 120px;
                            }
                        }
                    }
                }
            }
        }
    }
}